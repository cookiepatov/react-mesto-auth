(this["webpackJsonpmesto-react-auth"]=this["webpackJsonpmesto-react-auth"]||[]).push([[0],{29:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),c=n(21),r=n.n(c),o=(n(29),n(9)),i=n(23),l=n(2),u=n(15),d=n(16),p={inputClass:"popup__input",inputErrorClass:"popup__input_type_error",errorClass:"popup__error",errorClassVisible:"popup__error_visible"},b={inputClass:"auth-form__input",inputErrorClass:"auth-form__input_type_error",errorClass:"auth-form__error",errorClassVisible:"auth-form__error_visible"},j=new(function(){function e(t){Object(u.a)(this,e),this._baseUrl=t.baseUrl,this._token=t.headers.authorization,this._contentType=t.headers["Content-Type"]}return Object(d.a)(e,[{key:"_resultHandler",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getInitialCards",value:function(){var e=this;return fetch(this._baseUrl+"/cards",{headers:{authorization:this._token}}).then((function(t){return e._resultHandler(t)}))}},{key:"getUserInfo",value:function(){var e=this;return fetch(this._baseUrl+"/users/me",{headers:{authorization:this._token}}).then((function(t){return e._resultHandler(t)}))}},{key:"setUserInfo",value:function(e,t){var n=this;return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:{authorization:this._token,"Content-Type":this._contentType},body:JSON.stringify({name:e,about:t})}).then((function(e){return n._resultHandler(e)}))}},{key:"setUserAvatar",value:function(e){var t=this;return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:{authorization:this._token,"Content-Type":this._contentType},body:JSON.stringify({avatar:e})}).then((function(e){return t._resultHandler(e)}))}},{key:"addNewCard",value:function(e,t){var n=this;return fetch(this._baseUrl+"/cards",{method:"POST",headers:{authorization:this._token,"Content-Type":this._contentType},body:JSON.stringify({name:e,link:t})}).then((function(e){return n._resultHandler(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return t._resultHandler(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.likeCard(e):this.dislikeCard(e)}},{key:"likeCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:{authorization:this._token}}).then((function(e){return t._resultHandler(e)}))}},{key:"dislikeCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return t._resultHandler(e)}))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-22",headers:{authorization:"175f949a-57a4-4e41-845e-76eb0a4e61c1","Content-Type":"application/json"}}),h=new(function(){function e(t){Object(u.a)(this,e),this._baseUrl=t.baseUrl,this._contentType=t.headers["Content-Type"]}return Object(d.a)(e,[{key:"_resultHandler",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"authorize",value:function(e){var t=this,n=e.email,a=e.password;return console.log("/signin"),fetch(this._baseUrl+"/signin",{method:"POST",headers:{"Content-Type":this._contentType},body:JSON.stringify({password:a,email:n})}).then((function(e){return t._resultHandler(e)}))}},{key:"register",value:function(e){var t=this,n=e.email,a=e.password;return console.log("/signup"),fetch(this._baseUrl+"/signup",{method:"POST",headers:{"Content-Type":this._contentType},body:JSON.stringify({password:a,email:n})}).then((function(e){return t._resultHandler(e)}))}},{key:"checkToken",value:function(e){var t=this,n=e.jwt;return fetch(this._baseUrl+"/users/me",{method:"GET",headers:{"Content-Type":this._contentType,Authorization:"Bearer ".concat(n)}}).then((function(e){return t._resultHandler(e)}))}}]),e}())({baseUrl:"https://auth.nomoreparties.co",headers:{"Content-Type":"application/json"}}),m=Object(a.createContext)({}),f=n(3),O=n.p+"static/media/logo.bbe2a6ea.svg",_=n(0);var v=Object(f.j)((function(e){var t=e.currentLocation,n=e.login,s=e.signOut,c=Object(f.i)().url;console.log(t);var r=Object(a.useState)(!1),i=Object(l.a)(r,2),u=i[0],d=i[1],p=Object(a.useState)("header"),b=Object(l.a)(p,2),j=b[0],h=b[1],m=u?{burgerClass:"header__humburger-button header__humburger-button_type_cross",rightBlockClass:"header__right-block header__right-block_visible"}:{burgerClass:"header__humburger-button",rightBlockClass:"header__right-block"},v=function(e,t,n,a,s,c,r){switch(e){case"/sign-in":return Object(_.jsx)(o.b,{className:"header__link",to:"".concat(r,"sign-up"),children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"});case"/":return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("button",{className:n,onClick:s}),Object(_.jsxs)("div",{className:a,children:[Object(_.jsx)("p",{className:"header__email",children:t}),Object(_.jsx)(o.b,{className:"header__link header__link_faded",to:"".concat(r,"sign-in"),onClick:c,children:"\u0412\u044b\u0439\u0442\u0438"})]})]});default:return Object(_.jsx)(o.b,{className:"header__link",to:"".concat(r,"sign-in"),children:"\u0412\u043e\u0439\u0442\u0438"})}}(t,n,m.burgerClass,m.rightBlockClass,(function(){d(!u),h("header"===j?"header header_lowered":"header")}),s,c),g="/"===t?"header__content":"header__content header__content_simple";return Object(_.jsxs)("header",{className:"header",children:[Object(_.jsx)("div",{className:g,children:Object(_.jsx)("img",{src:O,className:"logo",alt:"Mesto Russia"})}),v]})}));var g=function(e){var t=e.card,n=e.onCardClick,s=e.onDeleteClick,c=e.onCardLike,r=Object(a.useState)(!1),o=Object(l.a)(r,2),i=o[0],u=o[1],d=Object(a.useContext)(m)._id,p=t.likes,b=t.owner,j=t.name,h=t.link,f=b._id,O=d===f,v=p.some((function(e){return e._id===d})),g=O?"element__delete-button":"element__delete-button element__delete-button_hidden",C=i?"element__like-button_loading":"",x="element__like-button ".concat(v?"element__like-button element__like-button_active":""," ").concat(C);return Object(a.useEffect)((function(){u(!1)}),[p]),Object(_.jsxs)("figure",{className:"element",children:[Object(_.jsx)("button",{className:"element__picture-button",style:{backgroundImage:"url(".concat(h,")")},onClick:function(){n(t)}}),Object(_.jsx)("button",{type:"button",className:g,onClick:function(){s(t)}}),Object(_.jsxs)("figcaption",{className:"element__caption",children:[Object(_.jsx)("h2",{className:"element__text",children:j}),Object(_.jsxs)("div",{className:"element__like-container",children:[Object(_.jsx)("button",{type:"button",className:x,onClick:function(){c(t),u(!0)}}),Object(_.jsx)("p",{className:"element__like-counter",children:p.length})]})]})]})};var C=function(e){var t=e.onEditProfile,n=e.onAddPlace,s=e.onEditAvatar,c=e.onCardClick,r=e.cards,o=e.onCardLike,i=e.onCardDelete,l=Object(a.useContext)(m),u=l.name,d=l.about,p=l.avatar;return Object(_.jsxs)("main",{className:"content",children:[Object(_.jsxs)("section",{className:"profile",children:[Object(_.jsx)("button",{className:"profile__avatar-button",onClick:s,style:{backgroundImage:"url(".concat(p,")")}}),Object(_.jsxs)("div",{className:"profile__info",children:[Object(_.jsx)("h1",{className:"profile__name",children:u}),Object(_.jsx)("button",{type:"button",className:"profile__edit-button",onClick:t}),Object(_.jsx)("p",{className:"profile__description",children:d})]}),Object(_.jsx)("button",{type:"button",className:"profile__add-button",onClick:n})]}),Object(_.jsx)("section",{className:"elements",children:r.map((function(e){return Object(_.jsx)(g,{card:e,onCardClick:c,onDeleteClick:i,onCardLike:o},e._id)}))})]})};var x=function(){var e=(new Date).getFullYear();return Object(_.jsx)("footer",{className:"footer",children:Object(_.jsxs)("p",{className:"copyright",children:["\xa9 ",e," Mesto Russia"]})})};var k=function(e){var t=e.name,n=e.title,a=e.children,s=e.isOpen,c=e.onClose,r=e.onSubmit,o=e.formValidity,i=e.buttonText,l=s?"popup popup_type_".concat(t," popup_opened"):"popup popup_type_".concat(t);return Object(_.jsx)("section",{className:l,children:Object(_.jsxs)("div",{className:"popup__container",children:[Object(_.jsx)("button",{type:"button",className:"popup__close-button",onClick:c}),Object(_.jsx)("h2",{className:"popup__title",children:n}),Object(_.jsxs)("form",{className:"popup__form",name:t,onSubmit:r,children:[a,Object(_.jsx)("button",{type:"submit",className:"popup__button",disabled:!o,children:i})]})]})})},y=n(11),N=n(8);function S(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(a.useState)({}),n=Object(l.a)(t,2),s=n[0],c=n[1],r=Object(a.useState)({}),o=Object(l.a)(r,2),i=o[0],u=o[1],d=Object(a.useState)(!0),j=Object(l.a)(d,2),h=j[0],m=j[1],f=Object(a.useState)({}),O=Object(l.a)(f,2),_=O[0],v=O[1],g=Object(a.useState)({}),C=Object(l.a)(g,2),x=C[0],k=C[1],S=function(t){var n=t.target,a=e?b:p,r=a.inputClass,o=a.inputErrorClass,l=a.errorClass,d=a.errorClassVisible,j=n.name,h=n.value,f=n.validity.valid?r:"".concat(r," ").concat(o),O=n.validity.valid?l:"".concat(l," ").concat(d);c(Object(N.a)(Object(N.a)({},s),{},Object(y.a)({},j,h))),u(Object(N.a)(Object(N.a)({},i),{},Object(y.a)({},j,n.validationMessage))),v(Object(N.a)(Object(N.a)({},_),{},Object(y.a)({},j,f))),k(Object(N.a)(Object(N.a)({},x),{},Object(y.a)({},j,O))),m(n.closest("form").checkValidity())},w=Object(a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];c(e),u(t),m(s),v(n),k(a)}),[c,u,m]);return{values:s,handleChange:S,errors:i,inputsClasses:_,errorsClasses:x,isValid:h,resetForm:w,setValues:c,setIsValid:m}}var w=function(e){var t=e.isOpen,n=e.onClose,s=e.onUpdateUser,c=e.isLoading,r=p.inputClass,o=p.errorClass,i=S(),u=i.values,d=i.handleChange,b=i.errors,j=i.inputsClasses,h=i.errorsClasses,f=i.isValid,O=i.resetForm,v=Object(a.useContext)(m),g=Object(a.useState)("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),C=Object(l.a)(g,2),x=C[0],y=C[1],N=Object(a.useRef)();return Object(a.useEffect)((function(){if(c){var e=[".","..","..."],t=0;N.current=setInterval((function(){y("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),200)}else clearInterval(N.current),y("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[c]),Object(a.useEffect)((function(){O({name:v.name,description:v.about},{name:"",description:""},{name:r,description:r},{name:o,description:o},!0)}),[t]),Object(_.jsxs)(k,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault();var t=u.name,n=u.description;s({name:t,about:n})},buttonText:x,formValidity:f,children:[Object(_.jsx)("input",{id:"profile-name-input",name:"name",required:!0,minLength:"2",maxLength:"40",className:j.name||"",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",value:u.name,onChange:d}),Object(_.jsx)("span",{className:h.name,children:b.name}),Object(_.jsx)("input",{id:"profile-description-input",name:"description",required:!0,minLength:"2",maxLength:"200",className:j.description,placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",value:u.description||"",onChange:d}),Object(_.jsx)("span",{className:h.description,children:b.description})]})};var T=function(e){var t=e.isOpen,n=e.onClose,a=e.selectedCard,s=a?a.link:"#",c=a?a.name:"",r=t?"popup popup_opened popup_type_full-view":"popup popup_type_full-view";return Object(_.jsx)("section",{className:r,children:Object(_.jsx)("figure",{className:"popup__picture-container",children:Object(_.jsxs)("div",{className:"popup__picture-elements",children:[Object(_.jsx)("button",{type:"button",className:"popup__close-button",onClick:n}),Object(_.jsx)("img",{className:"popup__full-picture",alt:"\u041f\u043e\u043b\u043d\u043e\u044d\u043a\u0440\u0430\u043d\u043d\u044b\u0439 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440",src:s}),Object(_.jsx)("h2",{className:"popup__picture-title",children:c})]})})})};var L=function(e){var t=e.isOpen,n=e.onClose,s=e.onUpdateAvatar,c=e.isLoading,r=p.inputClass,o=p.errorClass,i=S(),u=i.values,d=i.handleChange,b=i.errors,j=i.inputsClasses,h=i.errorsClasses,m=i.isValid,f=i.resetForm,O=Object(a.useState)("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),v=Object(l.a)(O,2),g=v[0],C=v[1],x=Object(a.useRef)();return Object(a.useEffect)((function(){if(c){var e=[".","..","..."],t=0;x.current=setInterval((function(){C("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),200)}else clearInterval(x.current),C("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[c]),Object(a.useEffect)((function(){f({data:""},{data:""},{data:r},{data:o},!1)}),[t]),Object(_.jsxs)(k,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),s(u.data)},buttonText:g,formValidity:m,children:[Object(_.jsx)("input",{id:"avatar-link-input",name:"data",required:!0,type:"url",className:j.data,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",value:u.data||"",onChange:d}),Object(_.jsx)("span",{className:h.data,children:b.data})]})};var E=function(e){var t=e.isOpen,n=e.onClose,s=e.onAddPlace,c=e.isLoading,r=p.inputClass,o=p.errorClass,i=S(),u=i.values,d=i.handleChange,b=i.errors,j=i.inputsClasses,h=i.errorsClasses,m=i.isValid,f=i.resetForm,O=Object(a.useState)("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),v=Object(l.a)(O,2),g=v[0],C=v[1],x=Object(a.useRef)();return Object(a.useEffect)((function(){if(c){var e=[".","..","..."],t=0;x.current=setInterval((function(){C("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),200)}else clearInterval(x.current),C("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[c]),Object(a.useEffect)((function(){f({name:"",data:""},{name:"",data:""},{name:r,data:r},{name:o,data:o})}),[t]),Object(_.jsxs)(k,{name:"card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault();var t=u.name,n=u.data;s({name:t,link:n})},buttonText:g,formValidity:m,children:[Object(_.jsx)("input",{id:"place-name-input",name:"name",required:!0,minLength:"2",maxLength:"30",className:j.name,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",onChange:d,value:u.name||""}),Object(_.jsx)("span",{className:h.name,children:b.name}),Object(_.jsx)("input",{id:"place-link-input",name:"data",required:!0,type:"url",className:j.data,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",onChange:d,value:u.data||""}),Object(_.jsx)("span",{className:h.data,children:b.data})]})};var U=function(e){var t=e.isOpen,n=e.onClose,s=e.selectedCard,c=e.onDeleteCard,r=e.isLoading,o=Object(a.useState)("\u0414\u0430"),i=Object(l.a)(o,2),u=i[0],d=i[1],p=Object(a.useRef)();return Object(a.useEffect)((function(){if(r){var e=[".","..","..."],t=0;p.current=setInterval((function(){d("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),200)}else clearInterval(p.current),d("\u0414\u0430")}),[r]),Object(_.jsx)(k,{name:"remove-card",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c(s)},buttonText:u,formValidity:!0})},I=n.p+"static/media/check.a9eb6caf.svg",P=n.p+"static/media/cross.d4ce2a26.svg";var V=function(e){var t=e.isOpen,n=e.onClose,a=t?"popup popup_type_tooltip popup_opened":"popup popup_type_tooltip",s=e.accepted?{text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",picSrc:I}:{text:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",picSrc:P},c=s.text,r=s.picSrc;return Object(_.jsx)("section",{className:a,children:Object(_.jsxs)("div",{className:"popup__container",children:[Object(_.jsx)("button",{type:"button",className:"popup__close-button popup__close-button_type_info",onClick:n}),Object(_.jsx)("img",{className:"popup__info-img",alt:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",src:r}),Object(_.jsx)("p",{className:"popup__info-text",children:c})]})})};var D=Object(f.j)((function(e){var t=e.loggedIn,n=e.onSubmit,s=e.isRegisterForm,c=Object(f.i)().url,r=b.inputClass,i=b.errorClass,l=S(!0),u=l.values,d=l.handleChange,p=l.errors,j=l.inputsClasses,h=l.errorsClasses,m=l.isValid,O=l.resetForm;Object(a.useEffect)((function(){O({email:"",password:""},{email:"",password:""},{email:r,password:r},{email:i,password:i})}),[t]);var v=s?"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f":"\u0412\u043e\u0439\u0442\u0438",g=s?"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f":"\u0412\u0445\u043e\u0434";return Object(_.jsxs)("form",{className:"auth-form",onSubmit:function(e){e.preventDefault(),n(u)},children:[Object(_.jsx)("h2",{className:"auth-form__header",children:g}),Object(_.jsxs)("fieldset",{className:"auth-form__inputs",children:[Object(_.jsx)("input",{className:j.email,id:"email-input",type:"email",required:!0,name:"email",minLength:"2",maxLength:"30",placeholder:"Email",value:u.email||"",onChange:d}),Object(_.jsx)("span",{className:h.email,children:p.email}),Object(_.jsx)("input",{className:j.password,id:"password-input",type:"password",required:!0,name:"password",minLength:"7",maxLength:"30",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:u.password||"",onChange:d}),Object(_.jsx)("span",{className:h.password,children:p.password})]}),Object(_.jsx)("button",{className:"auth-form__button",type:"submit",disabled:!m,children:v}),s&&Object(_.jsxs)("p",{className:"auth-form__bottom-message",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",Object(_.jsx)(o.b,{className:"auth__link",to:"".concat(c,"/sign-in"),children:" \u0412\u043e\u0439\u0442\u0438 "})]})]})})),H=n(24),F=["component"],z=function(e){var t=e.component,n=Object(H.a)(e,F);return Object(_.jsx)(f.b,{children:function(){return n.loggedIn?Object(_.jsx)(t,Object(N.a)({},n)):Object(_.jsx)(f.a,{to:"/sign-in"})}})};var A=Object(f.j)((function(){var e=Object(f.g)(),t=Object(f.i)(),n=t.path,s=t.url;console.log({path:n,url:s});var c=Object(a.useState)(!1),r=Object(l.a)(c,2),o=r[0],u=r[1],d=Object(a.useState)(!1),p=Object(l.a)(d,2),b=p[0],O=p[1],g=Object(a.useState)(!1),k=Object(l.a)(g,2),y=k[0],N=k[1],S=Object(a.useState)(!1),I=Object(l.a)(S,2),P=I[0],H=I[1],F=Object(a.useState)(!1),A=Object(l.a)(F,2),R=A[0],q=A[1],J=Object(a.useState)(!1),B=Object(l.a)(J,2),M=B[0],G=B[1],Y=Object(a.useState)({}),K=Object(l.a)(Y,2),Q=K[0],W=K[1],X=Object(a.useState)({}),Z=Object(l.a)(X,2),$=Z[0],ee=Z[1],te=Object(a.useState)([]),ne=Object(l.a)(te,2),ae=ne[0],se=ne[1],ce=Object(a.useState)({}),re=Object(l.a)(ce,2),oe=re[0],ie=re[1],le=Object(a.useState)(!1),ue=Object(l.a)(le,2),de=ue[0],pe=ue[1],be=Object(a.useState)(!1),je=Object(l.a)(be,2),he=je[0],me=je[1],fe=Object(a.useState)(!1),Oe=Object(l.a)(fe,2),_e=Oe[0],ve=Oe[1],ge=Object(a.useState)(""),Ce=Object(l.a)(ge,2),xe=Ce[0],ke=Ce[1];function ye(e){G(!0),ve(e),Se()}function Ne(){document.removeEventListener("keydown",we),document.removeEventListener("pointerdown",Te),N(!1),u(!1),O(!1),H(!1),q(!1),G(!1),W({}),ie({})}function Se(){document.addEventListener("keydown",we),document.addEventListener("pointerdown",Te)}Object(a.useEffect)((function(){Promise.all([j.getUserInfo(),j.getInitialCards()]).then((function(t){var n=Object(l.a)(t,2),a=n[0],s=n[1];!function(){var t=localStorage.getItem("jwt");t&&h.checkToken({jwt:t}).then((function(t){ke(t.data.email),me(!0),e.push("/")})).catch((function(e){ye(!1),console.log(e)}))}(),ee(a),se(s)})).catch((function(e){ye(!1),console.log(e)}))}),[]);var we=Object(a.useCallback)((function(e){"Escape"===e.key&&Ne()}),[]),Te=Object(a.useCallback)((function(e){e.target.classList.contains("popup")&&Ne()}),[]);return Object(_.jsx)(m.Provider,{value:$,children:Object(_.jsxs)("div",{className:"page",children:[Object(_.jsx)(v,{currentLocation:Object(f.h)().pathname,login:xe,signOut:function(){localStorage.removeItem("jwt")}}),Object(_.jsxs)(f.d,{children:[Object(_.jsx)(f.b,{exact:!0,path:"".concat(n,"sign-in"),children:Object(_.jsx)(D,{loggedIn:he,onSubmit:function(t){var a=t.email,s=t.password;h.authorize({email:a,password:s}).then((function(t){var s;me(!0),ke(a),s=t.token,localStorage.setItem("jwt",s),e.push(n)})).catch((function(e){ye(!1),console.log(e)}))},isRegisterForm:!1})}),Object(_.jsx)(f.b,{exact:!0,path:"".concat(n,"sign-up"),children:Object(_.jsx)(D,{loggedIn:he,onSubmit:function(t){var a=t.email,s=t.password;h.register({email:a,password:s}).then((function(t){ye(!0),e.push("".concat(n,"sign-in"))})).catch((function(e){ye(!1),console.log(e)}))},isRegisterForm:!0})}),Object(_.jsx)(z,{exact:!0,path:n,loggedIn:he,component:C,onEditProfile:function(){Se(),u(!0)},onAddPlace:function(){Se(),O(!0)},onEditAvatar:function(){Se(),N(!0)},onCardClick:function(e){Se(),q(!0),W(e)},cards:ae,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===$._id}));j.changeLikeCardStatus(e._id,!t).then((function(t){se((function(n){return n.map((function(n){return n._id===e._id?t:n}))})),Ne()})).catch((function(e){ye(!1),console.log(e)}))},onCardDelete:function(e){Se(),H(!0),ie(e)}})]}),Object(_.jsx)(x,{}),Object(_.jsx)(V,{onClose:Ne,isOpen:M,accepted:_e}),Object(_.jsx)(w,{onUpdateUser:function(e){var t=e.name,n=e.about;pe(!0),j.setUserInfo(t,n).then((function(e){ee(e),Ne()})).catch((function(e){ye(!1),console.log(e)})).finally((function(){pe(!1)}))},onClose:Ne,isOpen:o,isLoading:de}),Object(_.jsx)(E,{onAddPlace:function(e){var t=e.name,n=e.link;pe(!0),j.addNewCard(t,n).then((function(e){se((function(t){return[e].concat(Object(i.a)(t))})),Ne()})).catch((function(e){ye(!1),console.log(e)})).finally((function(){pe(!1)}))},onClose:Ne,isOpen:b,isLoading:de}),Object(_.jsx)(L,{onUpdateAvatar:function(e){pe(!0),j.setUserAvatar(e).then((function(e){ee(e),Ne()})).catch((function(e){ye(!1),console.log(e)})).finally((function(){pe(!1)}))},onClose:Ne,isOpen:y,isLoading:de}),Object(_.jsx)(U,{onDeleteCard:function(e){pe(!0),j.deleteCard(e._id).then((function(){se((function(t){return t.filter((function(t){return t._id!==e._id}))})),Ne()})).catch((function(e){ye(!1),console.log(e)})).finally((function(){pe(!1)}))},onClose:Ne,isOpen:P,selectedCard:oe,isLoading:de}),Object(_.jsx)(T,{isOpen:R,onClose:Ne,selectedCard:Q})]})})})),R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,40)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),c(e),r(e)}))};r.a.render(Object(_.jsx)(s.a.StrictMode,{children:Object(_.jsx)(o.a,{children:Object(_.jsx)(A,{})})}),document.getElementById("root")),R()}},[[39,1,2]]]);
//# sourceMappingURL=main.5392923c.chunk.js.map
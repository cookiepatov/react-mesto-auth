(this["webpackJsonpmesto-react-auth"]=this["webpackJsonpmesto-react-auth"]||[]).push([[0],{29:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),c=n(21),r=n.n(c),o=(n(29),n(9)),i=n(23),l=n(2),u=n(15),d=n(16),p={inputClass:"popup__input",inputErrorClass:"popup__input_type_error",errorClass:"popup__error",errorClassVisible:"popup__error_visible"},b={inputClass:"auth-form__input",inputErrorClass:"auth-form__input_type_error",errorClass:"auth-form__error",errorClassVisible:"auth-form__error_visible"},j=new(function(){function e(t){Object(u.a)(this,e),this._baseUrl=t.baseUrl,this._token=t.headers.authorization,this._contentType=t.headers["Content-Type"]}return Object(d.a)(e,[{key:"_resultHandler",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getInitialCards",value:function(){var e=this;return fetch(this._baseUrl+"/cards",{headers:{authorization:this._token}}).then((function(t){return e._resultHandler(t)}))}},{key:"getUserInfo",value:function(){var e=this;return fetch(this._baseUrl+"/users/me",{headers:{authorization:this._token}}).then((function(t){return e._resultHandler(t)}))}},{key:"setUserInfo",value:function(e,t){var n=this;return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:{authorization:this._token,"Content-Type":this._contentType},body:JSON.stringify({name:e,about:t})}).then((function(e){return n._resultHandler(e)}))}},{key:"setUserAvatar",value:function(e){var t=this;return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:{authorization:this._token,"Content-Type":this._contentType},body:JSON.stringify({avatar:e})}).then((function(e){return t._resultHandler(e)}))}},{key:"addNewCard",value:function(e,t){var n=this;return fetch(this._baseUrl+"/cards",{method:"POST",headers:{authorization:this._token,"Content-Type":this._contentType},body:JSON.stringify({name:e,link:t})}).then((function(e){return n._resultHandler(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return t._resultHandler(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.likeCard(e):this.dislikeCard(e)}},{key:"likeCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:{authorization:this._token}}).then((function(e){return t._resultHandler(e)}))}},{key:"dislikeCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return t._resultHandler(e)}))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-22",headers:{authorization:"175f949a-57a4-4e41-845e-76eb0a4e61c1","Content-Type":"application/json"}}),h=new(function(){function e(t){Object(u.a)(this,e),this._baseUrl=t.baseUrl,this._contentType=t.headers["Content-Type"]}return Object(d.a)(e,[{key:"_resultHandler",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"authorize",value:function(e){var t=this,n=e.email,a=e.password;return console.log("/signin"),fetch(this._baseUrl+"/signin",{method:"POST",headers:{"Content-Type":this._contentType},body:JSON.stringify({password:a,email:n})}).then((function(e){return t._resultHandler(e)}))}},{key:"register",value:function(e){var t=this,n=e.email,a=e.password;return console.log("/signup"),fetch(this._baseUrl+"/signup",{method:"POST",headers:{"Content-Type":this._contentType},body:JSON.stringify({password:a,email:n})}).then((function(e){return t._resultHandler(e)}))}},{key:"checkToken",value:function(e){var t=this,n=e.jwt;return fetch(this._baseUrl+"/users/me",{method:"GET",headers:{"Content-Type":this._contentType,Authorization:"Bearer ".concat(n)}}).then((function(e){return t._resultHandler(e)}))}}]),e}())({baseUrl:"https://auth.nomoreparties.co",headers:{"Content-Type":"application/json"}}),m=Object(a.createContext)({}),f=n(3),O=n.p+"static/media/logo.bbe2a6ea.svg",_=n(0);var v=Object(f.i)((function(e){var t=e.currentLocation,n=e.login,s=e.signOut,c=Object(a.useState)(!1),r=Object(l.a)(c,2),i=r[0],u=r[1],d=Object(a.useState)("header"),p=Object(l.a)(d,2),b=p[0],j=p[1],h=i?{burgerClass:"header__humburger-button header__humburger-button_type_cross",rightBlockClass:"header__right-block header__right-block_visible"}:{burgerClass:"header__humburger-button",rightBlockClass:"header__right-block"},m=function(e,t,n,a,s,c){switch(e){case"/sign-in":return Object(_.jsx)(o.b,{className:"header__link",to:"/sign-up",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"});case"/":return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("button",{className:n,onClick:s}),Object(_.jsxs)("div",{className:a,children:[Object(_.jsx)("p",{className:"header__email",children:t}),Object(_.jsx)(o.b,{className:"header__link header__link_faded",to:"/sign-in",onClick:c,children:"\u0412\u044b\u0439\u0442\u0438"})]})]});default:return Object(_.jsx)(o.b,{className:"header__link",to:"/sign-in",children:"\u0412\u043e\u0439\u0442\u0438"})}}(t,n,h.burgerClass,h.rightBlockClass,(function(){u(!i),j("header"===b?"header header_lowered":"header")}),s),f="/"===t?"header__content":"header__content header__content_simple";return Object(_.jsxs)("header",{className:"header",children:[Object(_.jsx)("div",{className:f,children:Object(_.jsx)("img",{src:O,className:"logo",alt:"Mesto Russia"})}),m]})}));var g=function(e){var t=e.card,n=e.onCardClick,s=e.onDeleteClick,c=e.onCardLike,r=Object(a.useState)(!1),o=Object(l.a)(r,2),i=o[0],u=o[1],d=Object(a.useContext)(m)._id,p=t.likes,b=t.owner,j=t.name,h=t.link,f=b._id,O=d===f,v=p.some((function(e){return e._id===d})),g=O?"element__delete-button":"element__delete-button element__delete-button_hidden",C=i?"element__like-button_loading":"",x="element__like-button ".concat(v?"element__like-button element__like-button_active":""," ").concat(C);return Object(a.useEffect)((function(){u(!1)}),[p]),Object(_.jsxs)("figure",{className:"element",children:[Object(_.jsx)("button",{className:"element__picture-button",style:{backgroundImage:"url(".concat(h,")")},onClick:function(){n(t)}}),Object(_.jsx)("button",{type:"button",className:g,onClick:function(){s(t)}}),Object(_.jsxs)("figcaption",{className:"element__caption",children:[Object(_.jsx)("h2",{className:"element__text",children:j}),Object(_.jsxs)("div",{className:"element__like-container",children:[Object(_.jsx)("button",{type:"button",className:x,onClick:function(){c(t),u(!0)}}),Object(_.jsx)("p",{className:"element__like-counter",children:p.length})]})]})]})};var C=function(e){var t=e.onEditProfile,n=e.onAddPlace,s=e.onEditAvatar,c=e.onCardClick,r=e.cards,o=e.onCardLike,i=e.onCardDelete,l=Object(a.useContext)(m),u=l.name,d=l.about,p=l.avatar;return Object(_.jsxs)("main",{className:"content",children:[Object(_.jsxs)("section",{className:"profile",children:[Object(_.jsx)("button",{className:"profile__avatar-button",onClick:s,style:{backgroundImage:"url(".concat(p,")")}}),Object(_.jsxs)("div",{className:"profile__info",children:[Object(_.jsx)("h1",{className:"profile__name",children:u}),Object(_.jsx)("button",{type:"button",className:"profile__edit-button",onClick:t}),Object(_.jsx)("p",{className:"profile__description",children:d})]}),Object(_.jsx)("button",{type:"button",className:"profile__add-button",onClick:n})]}),Object(_.jsx)("section",{className:"elements",children:r.map((function(e){return Object(_.jsx)(g,{card:e,onCardClick:c,onDeleteClick:i,onCardLike:o},e._id)}))})]})};var x=function(){var e=(new Date).getFullYear();return Object(_.jsx)("footer",{className:"footer",children:Object(_.jsxs)("p",{className:"copyright",children:["\xa9 ",e," Mesto Russia"]})})};var k=function(e){var t=e.name,n=e.title,a=e.children,s=e.isOpen,c=e.onClose,r=e.onSubmit,o=e.formValidity,i=e.buttonText,l=s?"popup popup_type_".concat(t," popup_opened"):"popup popup_type_".concat(t);return Object(_.jsx)("section",{className:l,children:Object(_.jsxs)("div",{className:"popup__container",children:[Object(_.jsx)("button",{type:"button",className:"popup__close-button",onClick:c}),Object(_.jsx)("h2",{className:"popup__title",children:n}),Object(_.jsxs)("form",{className:"popup__form",name:t,onSubmit:r,children:[a,Object(_.jsx)("button",{type:"submit",className:"popup__button",disabled:!o,children:i})]})]})})},y=n(11),N=n(8);function S(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(a.useState)({}),n=Object(l.a)(t,2),s=n[0],c=n[1],r=Object(a.useState)({}),o=Object(l.a)(r,2),i=o[0],u=o[1],d=Object(a.useState)(!0),j=Object(l.a)(d,2),h=j[0],m=j[1],f=Object(a.useState)({}),O=Object(l.a)(f,2),_=O[0],v=O[1],g=Object(a.useState)({}),C=Object(l.a)(g,2),x=C[0],k=C[1],S=function(t){var n=t.target,a=e?b:p,r=a.inputClass,o=a.inputErrorClass,l=a.errorClass,d=a.errorClassVisible,j=n.name,h=n.value,f=n.validity.valid?r:"".concat(r," ").concat(o),O=n.validity.valid?l:"".concat(l," ").concat(d);c(Object(N.a)(Object(N.a)({},s),{},Object(y.a)({},j,h))),u(Object(N.a)(Object(N.a)({},i),{},Object(y.a)({},j,n.validationMessage))),v(Object(N.a)(Object(N.a)({},_),{},Object(y.a)({},j,f))),k(Object(N.a)(Object(N.a)({},x),{},Object(y.a)({},j,O))),m(n.closest("form").checkValidity())},w=Object(a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];c(e),u(t),m(s),v(n),k(a)}),[c,u,m]);return{values:s,handleChange:S,errors:i,inputsClasses:_,errorsClasses:x,isValid:h,resetForm:w,setValues:c,setIsValid:m}}var w=function(e){var t=e.isOpen,n=e.onClose,s=e.onUpdateUser,c=e.isLoading,r=p.inputClass,o=p.errorClass,i=S(),u=i.values,d=i.handleChange,b=i.errors,j=i.inputsClasses,h=i.errorsClasses,f=i.isValid,O=i.resetForm,v=Object(a.useContext)(m),g=Object(a.useState)("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),C=Object(l.a)(g,2),x=C[0],y=C[1],N=Object(a.useRef)();return Object(a.useEffect)((function(){if(c){var e=[".","..","..."],t=0;N.current=setInterval((function(){y("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),200)}else clearInterval(N.current),y("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[c]),Object(a.useEffect)((function(){O({name:v.name,description:v.about},{name:"",description:""},{name:r,description:r},{name:o,description:o},!0)}),[t]),Object(_.jsxs)(k,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault();var t=u.name,n=u.description;s({name:t,about:n})},buttonText:x,formValidity:f,children:[Object(_.jsx)("input",{id:"profile-name-input",name:"name",required:!0,minLength:"2",maxLength:"40",className:j.name,placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",value:u.name||"",onChange:d}),Object(_.jsx)("span",{className:h.name,children:b.name}),Object(_.jsx)("input",{id:"profile-description-input",name:"description",required:!0,minLength:"2",maxLength:"200",className:j.description,placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",value:u.description||"",onChange:d}),Object(_.jsx)("span",{className:h.description,children:b.description})]})};var T=function(e){var t=e.isOpen,n=e.onClose,a=e.selectedCard,s=a?a.link:"#",c=a?a.name:"",r=t?"popup popup_opened popup_type_full-view":"popup popup_type_full-view";return Object(_.jsx)("section",{className:r,children:Object(_.jsx)("figure",{className:"popup__picture-container",children:Object(_.jsxs)("div",{className:"popup__picture-elements",children:[Object(_.jsx)("button",{type:"button",className:"popup__close-button",onClick:n}),Object(_.jsx)("img",{className:"popup__full-picture",alt:"\u041f\u043e\u043b\u043d\u043e\u044d\u043a\u0440\u0430\u043d\u043d\u044b\u0439 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440",src:s}),Object(_.jsx)("h2",{className:"popup__picture-title",children:c})]})})})};var L=function(e){var t=e.isOpen,n=e.onClose,s=e.onUpdateAvatar,c=e.isLoading,r=p.inputClass,o=p.errorClass,i=S(),u=i.values,d=i.handleChange,b=i.errors,j=i.inputsClasses,h=i.errorsClasses,m=i.isValid,f=i.resetForm,O=Object(a.useState)("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),v=Object(l.a)(O,2),g=v[0],C=v[1],x=Object(a.useRef)();return Object(a.useEffect)((function(){if(c){var e=[".","..","..."],t=0;x.current=setInterval((function(){C("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),200)}else clearInterval(x.current),C("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[c]),Object(a.useEffect)((function(){f({data:""},{data:""},{data:r},{data:o},!1)}),[t]),Object(_.jsxs)(k,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),s(u.data)},buttonText:g,formValidity:m,children:[Object(_.jsx)("input",{id:"avatar-link-input",name:"data",required:!0,type:"url",className:j.data,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",value:u.data||"",onChange:d}),Object(_.jsx)("span",{className:h.data,children:b.data})]})};var E=function(e){var t=e.isOpen,n=e.onClose,s=e.onAddPlace,c=e.isLoading,r=p.inputClass,o=p.errorClass,i=S(),u=i.values,d=i.handleChange,b=i.errors,j=i.inputsClasses,h=i.errorsClasses,m=i.isValid,f=i.resetForm,O=Object(a.useState)("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),v=Object(l.a)(O,2),g=v[0],C=v[1],x=Object(a.useRef)();return Object(a.useEffect)((function(){if(c){var e=[".","..","..."],t=0;x.current=setInterval((function(){C("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),200)}else clearInterval(x.current),C("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[c]),Object(a.useEffect)((function(){f({name:"",data:""},{name:"",data:""},{name:r,data:r},{name:o,data:o})}),[t]),Object(_.jsxs)(k,{name:"card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault();var t=u.name,n=u.data;s({name:t,link:n})},buttonText:g,formValidity:m,children:[Object(_.jsx)("input",{id:"place-name-input",name:"name",required:!0,minLength:"2",maxLength:"30",className:j.name,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",onChange:d,value:u.name||""}),Object(_.jsx)("span",{className:h.name,children:b.name}),Object(_.jsx)("input",{id:"place-link-input",name:"data",required:!0,type:"url",className:j.data,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",onChange:d,value:u.data||""}),Object(_.jsx)("span",{className:h.data,children:b.data})]})};var I=function(e){var t=e.isOpen,n=e.onClose,s=e.selectedCard,c=e.onDeleteCard,r=e.isLoading,o=Object(a.useState)("\u0414\u0430"),i=Object(l.a)(o,2),u=i[0],d=i[1],p=Object(a.useRef)();return Object(a.useEffect)((function(){if(r){var e=[".","..","..."],t=0;p.current=setInterval((function(){d("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),200)}else clearInterval(p.current),d("\u0414\u0430")}),[r]),Object(_.jsx)(k,{name:"remove-card",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c(s)},buttonText:u,formValidity:!0})},U=n.p+"static/media/check.a9eb6caf.svg",P=n.p+"static/media/cross.d4ce2a26.svg";var V=function(e){var t=e.isOpen,n=e.onClose,a=t?"popup popup_type_tooltip popup_opened":"popup popup_type_tooltip",s=e.accepted?{text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",picSrc:U}:{text:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",picSrc:P},c=s.text,r=s.picSrc;return Object(_.jsx)("section",{className:a,children:Object(_.jsxs)("div",{className:"popup__container",children:[Object(_.jsx)("button",{type:"button",className:"popup__close-button popup__close-button_type_info",onClick:n}),Object(_.jsx)("img",{className:"popup__info-img",alt:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u043e\u043d\u043d\u043e\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435",src:r}),Object(_.jsx)("p",{className:"popup__info-text",children:c})]})})};var D=function(e){var t=e.loggedIn,n=e.onSubmit,s=e.buttonText,c=b.inputClass,r=b.errorClass,o=S(!0),i=o.values,l=o.handleChange,u=o.errors,d=o.inputsClasses,p=o.errorsClasses,j=o.isValid,h=o.resetForm;return Object(a.useEffect)((function(){h({email:"",password:""},{email:"",password:""},{email:c,password:c},{email:r,password:r})}),[t]),Object(_.jsxs)("form",{className:"auth-form__container",onSubmit:function(e){e.preventDefault(),n(i)},children:[Object(_.jsxs)("fieldset",{className:"auth-form__inputs",children:[Object(_.jsx)("input",{className:d.email,id:"email-input",type:"email",required:!0,name:"email",minLength:"2",maxLength:"30",placeholder:"Email",value:i.email||"",onChange:l}),Object(_.jsx)("span",{className:p.email,children:u.email}),Object(_.jsx)("input",{className:d.password,id:"password-input",type:"password",required:!0,name:"password",minLength:"7",maxLength:"30",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:i.password||"",onChange:l}),Object(_.jsx)("span",{className:p.password,children:u.password})]}),Object(_.jsx)("button",{className:"auth-form__button",type:"submit",disabled:!j,children:s})]})};var H=function(e){var t=e.loggedIn,n=e.onLogin;return Object(_.jsxs)("div",{className:"auth-form",children:[Object(_.jsx)("h2",{className:"auth-form__header",children:"\u0412\u0445\u043e\u0434"}),Object(_.jsx)(D,{loggedIn:t,onSubmit:n,buttonText:"\u0412\u043e\u0439\u0442\u0438"})]})};var z=Object(f.i)((function(e){var t=e.loggedIn,n=e.onRegister;return Object(_.jsxs)("div",{className:"auth-form",children:[Object(_.jsx)("h2",{className:"auth-form__header",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(_.jsx)(D,{buttonText:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",loggedIn:t,onSubmit:n}),Object(_.jsxs)("p",{className:"auth-form__bottom-message",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",Object(_.jsx)(o.b,{className:"auth__link",to:"/sign-in",children:" \u0412\u043e\u0439\u0442\u0438 "})]})]})})),A=n(24),F=["component"],R=function(e){var t=e.component,n=Object(A.a)(e,F);return Object(_.jsx)(f.b,{children:function(){return n.loggedIn?Object(_.jsx)(t,Object(N.a)({},n)):Object(_.jsx)(f.a,{to:"./sign-in"})}})};var q=Object(f.i)((function(){var e=Object(f.g)(),t=Object(a.useState)(!1),n=Object(l.a)(t,2),s=n[0],c=n[1],r=Object(a.useState)(!1),o=Object(l.a)(r,2),u=o[0],d=o[1],p=Object(a.useState)(!1),b=Object(l.a)(p,2),O=b[0],g=b[1],k=Object(a.useState)(!1),y=Object(l.a)(k,2),N=y[0],S=y[1],U=Object(a.useState)(!1),P=Object(l.a)(U,2),D=P[0],A=P[1],F=Object(a.useState)(!1),q=Object(l.a)(F,2),J=q[0],B=q[1],M=Object(a.useState)({}),G=Object(l.a)(M,2),Y=G[0],K=G[1],Q=Object(a.useState)({}),W=Object(l.a)(Q,2),X=W[0],Z=W[1],$=Object(a.useState)([]),ee=Object(l.a)($,2),te=ee[0],ne=ee[1],ae=Object(a.useState)({}),se=Object(l.a)(ae,2),ce=se[0],re=se[1],oe=Object(a.useState)(!1),ie=Object(l.a)(oe,2),le=ie[0],ue=ie[1],de=Object(a.useState)(!1),pe=Object(l.a)(de,2),be=pe[0],je=pe[1],he=Object(a.useState)(!1),me=Object(l.a)(he,2),fe=me[0],Oe=me[1],_e=Object(a.useState)(""),ve=Object(l.a)(_e,2),ge=ve[0],Ce=ve[1];function xe(e){B(!0),Oe(e),ye()}function ke(){document.removeEventListener("keydown",Ne),document.removeEventListener("pointerdown",Se),g(!1),c(!1),d(!1),S(!1),A(!1),B(!1),K({}),re({})}function ye(){document.addEventListener("keydown",Ne),document.addEventListener("pointerdown",Se)}Object(a.useEffect)((function(){Promise.all([j.getUserInfo(),j.getInitialCards()]).then((function(t){var n=Object(l.a)(t,2),a=n[0],s=n[1];!function(){var t=localStorage.getItem("jwt");t&&h.checkToken({jwt:t}).then((function(t){Ce(t.data.email),je(!0),e.push("/")})).catch((function(e){xe(!1),console.log(e)}))}(),Z(a),ne(s)})).catch((function(e){xe(!1),console.log(e)}))}),[]);var Ne=Object(a.useCallback)((function(e){"Escape"===e.key&&ke()}),[]),Se=Object(a.useCallback)((function(e){e.target.classList.contains("popup")&&ke()}),[]);return Object(_.jsx)(m.Provider,{value:X,children:Object(_.jsxs)("div",{className:"page",children:[Object(_.jsx)(v,{currentLocation:Object(f.h)().pathname,login:ge,signOut:function(){localStorage.removeItem("jwt")}}),Object(_.jsxs)(f.d,{children:[Object(_.jsx)(f.b,{exact:!0,path:"/sign-in",children:Object(_.jsx)(H,{loggedIn:be,onLogin:function(t){var n=t.email,a=t.password;h.authorize({email:n,password:a}).then((function(t){var a;je(!0),Ce(n),a=t.token,localStorage.setItem("jwt",a),e.push("/")})).catch((function(e){xe(!1),console.log(e)}))}})}),Object(_.jsx)(f.b,{exact:!0,path:"/sign-up",children:Object(_.jsx)(z,{loggedIn:be,onRegister:function(t){var n=t.email,a=t.password;h.register({email:n,password:a}).then((function(t){xe(!0),e.push("/sign-in")})).catch((function(e){xe(!1),console.log(e)}))}})}),Object(_.jsx)(R,{exact:!0,path:"/",loggedIn:be,component:C,onEditProfile:function(){ye(),c(!0)},onAddPlace:function(){ye(),d(!0)},onEditAvatar:function(){ye(),g(!0)},onCardClick:function(e){ye(),A(!0),K(e)},cards:te,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===X._id}));j.changeLikeCardStatus(e._id,!t).then((function(t){ne((function(n){return n.map((function(n){return n._id===e._id?t:n}))})),ke()})).catch((function(e){xe(!1),console.log(e)}))},onCardDelete:function(e){ye(),S(!0),re(e)}})]}),Object(_.jsx)(x,{}),Object(_.jsx)(V,{onClose:ke,isOpen:J,accepted:fe}),Object(_.jsx)(w,{onUpdateUser:function(e){var t=e.name,n=e.about;ue(!0),j.setUserInfo(t,n).then((function(e){Z(e),ke()})).catch((function(e){xe(!1),console.log(e)})).finally((function(){ue(!1)}))},onClose:ke,isOpen:s,isLoading:le}),Object(_.jsx)(E,{onAddPlace:function(e){var t=e.name,n=e.link;ue(!0),j.addNewCard(t,n).then((function(e){ne((function(t){return[e].concat(Object(i.a)(t))})),ke()})).catch((function(e){xe(!1),console.log(e)})).finally((function(){ue(!1)}))},onClose:ke,isOpen:u,isLoading:le}),Object(_.jsx)(L,{onUpdateAvatar:function(e){ue(!0),j.setUserAvatar(e).then((function(e){Z(e),ke()})).catch((function(e){xe(!1),console.log(e)})).finally((function(){ue(!1)}))},onClose:ke,isOpen:O,isLoading:le}),Object(_.jsx)(I,{onDeleteCard:function(e){ue(!0),j.deleteCard(e._id).then((function(){ne((function(t){return t.filter((function(t){return t._id!==e._id}))})),ke()})).catch((function(e){xe(!1),console.log(e)})).finally((function(){ue(!1)}))},onClose:ke,isOpen:N,selectedCard:ce,isLoading:le}),Object(_.jsx)(T,{isOpen:D,onClose:ke,selectedCard:Y})]})})})),J=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,40)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),c(e),r(e)}))};r.a.render(Object(_.jsx)(s.a.StrictMode,{children:Object(_.jsx)(o.a,{children:Object(_.jsx)(q,{})})}),document.getElementById("root")),J()}},[[39,1,2]]]);
//# sourceMappingURL=main.648ade00.chunk.js.map